# Mortality Prediction Model

This repository contains a machine learning model to predict patient mortality based on various medical features. The model is built using a Multi-Layer Perceptron (MLP) neural network implemented with TensorFlow and Keras. Additionally, synthetic data is generated using an adversarial neural network to balance the dataset.

## Important

To use the Streamlit interface, you must first generate the balanced dataset (`dataset_balanceado.csv`).

## Project Structure

- `datos_sinteticos.py`: Script to generate synthetic data using an adversarial neural network and save the balanced dataset.
- `modelo.py`: Script to preprocess data, train the MLP model, and save the trained model.
- `test_modelo.py`: Script to evaluate the trained model on test data and print the results.
- `graficos.py`: Script to generate evaluation plots, including the confusion matrix and ROC curve.
- `app.py`: Streamlit interface to visualize the training process and model evaluation.
- `torax modelacion - copia.xlsx`: Original dataset used for training and testing the model.
- `dataset_balanceado.csv`: Balanced dataset generated by `datos_sinteticos.py`.

## Data Preprocessing

The dataset is preprocessed by:
- Converting categorical variables to binary.
- Mapping categorical variables to numerical values.
- Scaling numerical features.

## Synthetic Data Generation

Synthetic data is generated using a Generative Adversarial Network (GAN) to balance the dataset:
- `datos_sinteticos.py` loads the original dataset, preprocesses it, and generates synthetic data for the minority class.
- The balanced dataset is saved as `dataset_balanceado.csv`.

## Model Training

The MLP model is trained using the following architecture:
- Input layer
- Four hidden layers with ReLU activation
- Output layer with sigmoid activation

Early stopping is used to prevent overfitting.

## Model Evaluation

The model is evaluated using:
- Test loss and accuracy
- Confusion matrix
- ROC curve

## Streamlit Interface

The Streamlit interface (`app.py`) provides a visual representation of the training process and model evaluation. It includes:
- A progress bar showing the training progress and estimated time remaining.
- A GIF showing the decision boundary evolution during training.
- Download button for the GIF.
- Evaluation metrics including test loss, accuracy, confusion matrix, and ROC curve.
- Explanation and conclusion of the model's performance.

### Usage

#### Step 1: Generate Synthetic Data

Run the following command to generate synthetic data and create a balanced dataset:

```sh
python datos_sinteticos.py
### Step 2: Train the Model
Run the following command to preproccess the balanced dataset, train the MLP model, and save the trained model:

```sh
python modelo.py

```

### Step 3: Evaluate the Model
Run the following command to evaluate the trained model on test data and print the results:

```sh
python test_modelo.py

```

### Step 4: Generate Evaluation Plots
Run the following command to generate evaluation plots, including the confusion matrix and ROC curve:

```sh
python graficos.py

```

## Requirements

Make sure you have the libraries installed:

```sh
pip install -r requirements.txt

```

